<!DOCTYPE html>
<html>
<head>
    <title>Mapa con Br√∫jula y Botones Personalizados</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        /* Fondo de la p√°gina negro */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            background: black;
        }
        #map { 
            height: 100vh; 
            width: 100%; 
        }

        /* Estilo de los botones (cambio de vista y zoom) */
        .leaflet-control-layers, .leaflet-control-zoom {
            background: rgba(0, 0, 0, 0.8) !important; /* Fondo negro */
            border-radius: 5px !important;
            border: none !important;
            box-shadow: none !important;
        }
        .leaflet-control-layers-toggle, .leaflet-control-zoom-in, .leaflet-control-zoom-out {
            background-color: transparent !important;
            border: none !important;
            color: white !important; /* S√≠mbolo blanco */
            font-size: 18px !important;
            line-height: 26px !important;
        }
        .leaflet-control-layers-toggle {
            width: 30px !important;
            height: 30px !important;
            background-image: none !important;
            text-align: center !important;
        }
        .leaflet-control-layers {
            position: absolute;
            top: 10px; /* Posici√≥n del bot√≥n de cambio de vista */
            left: 10px;
            z-index: 1000;
        }
        .leaflet-control-zoom {
            position: absolute;
            top: 80px; /* Bajar m√°s los botones de zoom */
            left: 10px;
            z-index: 1000;
        }

        /* Estilo de la br√∫jula */
        .compass-container {
            position: absolute;
            top: 10px; /* Subir la br√∫jula a la l√≠nea del bot√≥n de cambio de vista */
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 50%;
            width: 80px;
            height: 80px;
            z-index: 1000;
            padding: 10px;
            text-align: center;
            color: white;
            font-family: Arial;
            font-weight: bold;
            text-shadow: 1px 1px 2px black;
        }
        .compass-arrow {
            width: 60%;
            height: 60%;
            margin: 10% auto;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23FF0000"><path d="M12 2L4 22L12 17L20 22Z"/></svg>') no-repeat;
            background-size: contain;
            transition: transform 0.3s;
        }
        .compass-directions {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }
        .direction-n { position: absolute; top: 5px; left: 35%; }
        .direction-e { position: absolute; top: 40%; right: 5px; }
        .direction-s { position: absolute; bottom: 5px; left: 35%; }
        .direction-w { position: absolute; top: 40%; left: 5px; }
        .compass-degrees {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
        }

        /* √çcono personalizado para el bot√≥n de cambio de vista */
        .leaflet-control-layers-toggle::before {
            content: 'üõ†Ô∏è'; /* √çcono de herramienta (puedes cambiarlo) */
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="compass-container">
        <div class="compass-directions">
            <div class="direction-n">N</div>
            <div class="direction-e">E</div>
            <div class="direction-s">S</div>
            <div class="direction-w">W</div>
        </div>
        <div class="compass-arrow" id="compassArrow"></div>
        <div class="compass-degrees" id="compassDegrees">0¬∞</div>
    </div>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Mapa y capas
        var map = L.map('map').setView([19.4326, -99.1332], 13);
        var streetLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
        var satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}');
        streetLayer.addTo(map);

        // Control de capas (bot√≥n de cambio de vista)
        L.control.layers({ "Calle": streetLayer, "Sat√©lite": satelliteLayer }, null, {
            position: 'topleft' // Posici√≥n del bot√≥n de cambio de vista
        }).addTo(map);

        // Control de zoom (botones de zoom)
        L.control.zoom({
            position: 'topleft' // Posici√≥n de los botones de zoom
        }).addTo(map);

        // Variables para la br√∫jula y el cazador
        var hunterMarker, hunterPolyline, hunterLatLngs = [];
        var currentHeading = 0;

        // Funci√≥n para actualizar cazador y br√∫jula
        function updateHunter(lat, lng, heading) {
            // Verificar si el marcador del cazador ya existe
            if (!hunterMarker) {
                // Crear un nuevo marcador para el cazador
                hunterMarker = L.marker([lat, lng], { 
                    icon: L.icon({ 
                        iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png', // √çcono rojo
                        className: 'custom-icon' // Clase CSS personalizada
                    }) 
                }).addTo(map); // A√±adir el marcador al mapa

                // Crear una polil√≠nea para el recorrido del cazador
                hunterPolyline = L.polyline([], { color: 'red' }).addTo(map); // L√≠nea roja
                hunterLatLngs = []; // Array para almacenar las coordenadas del recorrido
            }

            // Actualizar la posici√≥n del marcador del cazador
            hunterMarker.setLatLng([lat, lng]);

            // A√±adir la nueva posici√≥n al array de coordenadas
            hunterLatLngs.push([lat, lng]);

            // Actualizar la polil√≠nea con las nuevas coordenadas
            hunterPolyline.setLatLngs(hunterLatLngs);

            // Actualizar la br√∫jula si se proporciona un heading
            if (heading !== undefined) {
                // Rotar la flecha de la br√∫jula seg√∫n el heading
                document.getElementById('compassArrow').style.transform = `rotate(${heading}deg)`;

                // Mostrar los grados en la br√∫jula
                document.getElementById('compassDegrees').textContent = `${Math.round(heading)}¬∞`;

                // Guardar el heading actual
                currentHeading = heading;
            }
        }

        // Ejemplo de uso (simulaci√≥n de datos)
        setInterval(() => {
            const heading = Math.random() * 360; // Simula un valor de heading
            updateHunter(19.4326, -99.1332, heading);
        }, 1000);
    </script>
</body>
</html>
